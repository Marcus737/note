# 全量复制
1. 从库发`sync`命令
2. 主库通过bgsave RDB给从库发数据
3. 若主库在这期间有写命令，会一并发给从库


# 增量复制
## 情况
- 断线重连： 使用增量复制
- 新增节点：必须全量复制
- 主服务器id更变： 全量复制

# 原理
目的是保持redis的高可用性
1. 集群启动时，主从库会先建立连接，为全量复制做准备
2. 进行全量同步给从库，依赖于内存快照RDB
3. 在全量复制的过程中，使用专门的replication buffer记录写操作
4. 全量复制完成后，将replication buffer的操作发送给从库，从库执行
5. 后续主库收到写操作就增量同步给从库

